import * as dotenv from "dotenv";
import * as path from "path";
import { initializeFirebase } from "../src/firebase/admin";
import { createChannel } from "../src/firebase/channelsService";
import { Channel } from "../src/models/channel";

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
const envPath = path.join(__dirname, "..", ".env");
dotenv.config({ path: envPath });
dotenv.config();

// –ù–∞—á–∞–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
const initialChannels: Channel[] = [
  {
    id: "babushka-dedushka",
    name: "–ë–∞–±—É—à–∫–∞ –∏ –î–µ–¥—É—à–∫–∞ Life",
    description: "–°–µ–º–µ–π–Ω—ã–π —é–º–æ—Ä, –¥–µ—Ä–µ–≤–µ–Ω—Å–∫–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞, –±–∞–±—É—à–∫–∞ –∏ –¥–µ–¥—É—à–∫–∞",
    language: "ru",
    durationSeconds: 8,
    ideaPromptTemplate:
      "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 5 –∏–¥–µ–π –¥–ª—è –æ—á–µ–Ω—å —Å–º–µ—à–Ω—ã—Ö 8-—Å–µ–∫—É–Ω–¥–Ω—ã—Ö –≤–∏–¥–µ–æ —Å –±–∞–±—É—à–∫–æ–π –∏ –¥–µ–¥—É—à–∫–æ–π. –í–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º, —Å —Å–µ–º–µ–π–Ω—ã–º —é–º–æ—Ä–æ–º, –ø–æ–Ω—è—Ç–Ω—ã–º –∑—Ä–∏—Ç–µ–ª—è–º –∏–∑ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: JSON-–º–∞—Å—Å–∏–≤ —Å –ø–æ–ª—è–º–∏ title –∏ description. –Ø–∑—ã–∫ ‚Äî —Ä—É—Å—Å–∫–∏–π.",
    videoPromptTemplate:
      "–ù–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–µ–¥—É—é—â–µ–π –∏–¥–µ–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Veo 3.1 Fast. –ü—Ä–æ–º–ø—Ç –¥–æ–ª–∂–µ–Ω –æ–ø–∏—Å—ã–≤–∞—Ç—å —Å—Ü–µ–Ω—É –Ω–∞ 8 —Å–µ–∫—É–Ω–¥ —Å —Ä—É—Å—Å–∫–æ–π –±–∞–±—É—à–∫–æ–π –∏ –¥–µ–¥—É—à–∫–æ–π, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω–∞—è —Å—ä—ë–º–∫–∞, —Ç—ë–ø–ª—ã–π —Å–≤–µ—Ç, –¥–µ—Ä–µ–≤–µ–Ω—Å–∫–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, —Å–µ–º–µ–π–Ω—ã–π —é–º–æ—Ä. –í –∫–æ–Ω—Ü–µ —Ä–æ–ª–∏–∫–∞ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –∏–ª–∏ —Ä–µ–ø–ª–∏–∫–æ–π —É–ø–æ–º—è–Ω—É—Ç—å —Å–∞–π—Ç hotwell.kz. –ü—Ä–æ–º–ø—Ç –¥–ª—è Veo –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ç–æ–º –∂–µ —è–∑—ã–∫–µ, —á—Ç–æ –∏ —è–∑—ã–∫ –∫–∞–Ω–∞–ª–∞ ({{LANGUAGE}}). –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ —è–∑—ã–∫–µ –∫–∞–Ω–∞–ª–∞.\n\n–ò–¥–µ—è: {{IDEA_TEXT}}",
    gdriveFolderId: null,
  },
  {
    id: "sipdeluxe",
    name: "SIPDeluxe.kz",
    description: "IT-—é–º–æ—Ä, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ",
    language: "ru",
    durationSeconds: 8,
    ideaPromptTemplate:
      "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 5 –∏–¥–µ–π –¥–ª—è —Å–º–µ—à–Ω—ã—Ö 8-—Å–µ–∫—É–Ω–¥–Ω—ã—Ö –≤–∏–¥–µ–æ –ø—Ä–æ IT, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ. –Æ–º–æ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–Ω—è—Ç–µ–Ω IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: JSON-–º–∞—Å—Å–∏–≤ —Å –ø–æ–ª—è–º–∏ title –∏ description. –Ø–∑—ã–∫ ‚Äî —Ä—É—Å—Å–∫–∏–π.",
    videoPromptTemplate:
      "–ù–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–µ–¥—É—é—â–µ–π –∏–¥–µ–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Veo 3.1 Fast. –ü—Ä–æ–º–ø—Ç –¥–æ–ª–∂–µ–Ω –æ–ø–∏—Å—ã–≤–∞—Ç—å —Å—Ü–µ–Ω—É –Ω–∞ 8 —Å–µ–∫—É–Ω–¥ —Å IT-—Ç–µ–º–∞—Ç–∏–∫–æ–π, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞, —è—Ä–∫–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —é–º–æ—Ä. –ü—Ä–æ–º–ø—Ç –¥–ª—è Veo –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ç–æ–º –∂–µ —è–∑—ã–∫–µ, —á—Ç–æ –∏ —è–∑—ã–∫ –∫–∞–Ω–∞–ª–∞ ({{LANGUAGE}}). –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ —è–∑—ã–∫–µ –∫–∞–Ω–∞–ª–∞.\n\n–ò–¥–µ—è: {{IDEA_TEXT}}",
    gdriveFolderId: null,
  },
  {
    id: "hotwell",
    name: "HotWell.kz",
    description: "–ó–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏, —Ñ–∏—Ç–Ω–µ—Å, –ó–û–ñ",
    language: "ru",
    durationSeconds: 8,
    ideaPromptTemplate:
      "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 5 –∏–¥–µ–π –¥–ª—è —Å–º–µ—à–Ω—ã—Ö 8-—Å–µ–∫—É–Ω–¥–Ω—ã—Ö –≤–∏–¥–µ–æ –ø—Ä–æ –∑–¥–æ—Ä–æ–≤—å–µ, —Ñ–∏—Ç–Ω–µ—Å –∏ –ó–û–ñ. –Æ–º–æ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º –∏ –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–º. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: JSON-–º–∞—Å—Å–∏–≤ —Å –ø–æ–ª—è–º–∏ title –∏ description. –Ø–∑—ã–∫ ‚Äî —Ä—É—Å—Å–∫–∏–π.",
    videoPromptTemplate:
      "–ù–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–µ–¥—É—é—â–µ–π –∏–¥–µ–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Veo 3.1 Fast. –ü—Ä–æ–º–ø—Ç –¥–æ–ª–∂–µ–Ω –æ–ø–∏—Å—ã–≤–∞—Ç—å —Å—Ü–µ–Ω—É –Ω–∞ 8 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ –∑–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏, —ç–Ω–µ—Ä–≥–∏—á–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É, –¥–∏–Ω–∞–º–∏—á–Ω—É—é —Å—ä—ë–º–∫—É. –ü—Ä–æ–º–ø—Ç –¥–ª—è Veo –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ç–æ–º –∂–µ —è–∑—ã–∫–µ, —á—Ç–æ –∏ —è–∑—ã–∫ –∫–∞–Ω–∞–ª–∞ ({{LANGUAGE}}). –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ —è–∑—ã–∫–µ –∫–∞–Ω–∞–ª–∞.\n\n–ò–¥–µ—è: {{IDEA_TEXT}}",
    gdriveFolderId: null,
  },
];

async function migrateChannels() {
  try {
    console.log("üî• –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase...");
    initializeFirebase();

    console.log("üì¶ –ù–∞—á–∏–Ω–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –∫–∞–Ω–∞–ª–æ–≤...");

    for (const channel of initialChannels) {
      try {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–∞–Ω–∞–ª
        const { getChannelById } = await import("../src/firebase/channelsService");
        const existing = await getChannelById(channel.id);
        
        if (existing) {
          console.log(`‚è≠Ô∏è  –ö–∞–Ω–∞–ª ${channel.id} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);
          continue;
        }

        await createChannel(channel);
        console.log(`‚úÖ –ö–∞–Ω–∞–ª ${channel.id} —Å–æ–∑–¥–∞–Ω`);
      } catch (error: any) {
        console.error(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞–Ω–∞–ª–∞ ${channel.id}:`, error.message);
      }
    }

    console.log("‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
    process.exit(0);
  } catch (error: any) {
    console.error("‚ùå –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:", error);
    process.exit(1);
  }
}

migrateChannels();

